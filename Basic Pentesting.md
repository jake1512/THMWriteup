# Task 1: Web App Testing and Privilege Escalation
### Deploy the machine and connect to our network
### Find the service exposed by the machine
_nmap -Pn -vv -A <ip_addr>_
### What is the name of the hidden directory on the web server(enter name without /)?
_gobuster dir -u <ip_addr> -w /usr/share/wordlists/dirb/common.txt_
**development**
### User brute-forcing to find the username and password
_enum4linux -A <ip_addr>_
Here we have 2 ways to approach this problem, or at least I found 2 ways.
- First, we can see the Share Enumeration, there is an interesting sharename: _Anonymous_. This means the SMB server allows Anonymous login.
	_smbclient //<ip_addr>/anonymous_ (Password is also anonymous)
	Now we want to look into the directory, find anything that stands out.
	_dir_
	We get a "staff.txt" file. Download and then open it, see what's up.
	_get staff.txt_
	_cat staff.txt_
	In the text file we can see 2 names: Jan and Kay.
	One of the two might be our bingo.
- Second, we can look at Users on <ip_addr> via RID cycling
	We get:
	- S-1-22-1-1000 Unix User\kay (Local User)
	- S-1-22-1-1001 Unix User\jan (Local User)
### What is the username?
**Jan**
### What is the password?
We can use hydra to bruteforce this one.
_hydra -t 4 -l Jan -P /usr/share/wordlists/rockyou.txt -vV <ip_addr> ssh_
It's gonna take some time.
**armando**
### What service do you use to access the server(answer in abbreviation in all caps)?
**SSH**
### Enumerate the machine to find any vectors for privilege escalation
So, after watching John Hammond's youtube walkthrough video, apparently there's a script called linpeas.sh that can enumerate through so many stuff to find privesc angles.
_[https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh](https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh)_
And we want to upload this file into the machine. There's a handy command called _scp_ that can do just that.
_scp linpeas.sh jan@<ip_addr>:/dev/shm_
/dev/shm is a temporary file storage filesystem, and for some reason we can and should upload our file here. In other cases we can upload our file to /tmp.
To be able to execute the script, we give it execute permission.
_chmod +x linpeas.sh_
_./linpeas.sh_
This will show you what you need to know, what to look for.
Scroll down a while and we can see 
![[Pasted image 20210510122004.png]]
<u>"Possible private SSH keys were found!
/home/kay/.ssh/id_rsa"</u>

Going to that directory, we discover that we can read the id\_rsa file. Let's get the file and maybe name it "kay\_id\_rsa".

With ssh and id\_rsa keys, we have to give the file 600 permission only as ssh requires that the private key files are not accessible by others.

_chown 600 kay_id_rsa_
_ssh -i kay_id_rsa kay@<ip_addr>_
With this command ssh requires us a password to use this rsa key. To find this password, we'll use johntheripper.

We have to convert the ssh file into something that john can understand, then we can bruteforce the password with rockyou

_ssh2john kay_id_rsa > kay_id_rsa.txt_
_john --wordlist=rockyou.txt kay_id_rsa.txt_
The result is _"beeswax"_

Input the password and voila, we're in.

Look in the kay's home directory and we see a _"pass.bak"_
_cat pass.bak_
**heresareallystrongpasswordthatfollowsthepasswordpolicy\$$**
# **And we're done**